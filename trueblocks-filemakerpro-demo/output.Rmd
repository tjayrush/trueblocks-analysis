---
subtitle: "TrueBlocks Explorer output"
date: "5/30/2019"
output: html_document
params:
  filepath: "data/TheButton-0x2b0ec0993a00b2ea625e3b37fcc74742f43a72fe.csv"
  address: "0x2b0ec0993a00b2ea625e3b37fcc74742f43a72fe"
  name: "The Button"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
require(tidyverse)
```

```{r message=FALSE, fig.align='center'}
params
data.set <- read_csv(params$filepath) %>%
  mutate(Date = as.POSIXct(Date, format="%m/%d/%Y %H:%M:%S"))

data.set %>%
  mutate(Type = ifelse(To == params$address, "In", ifelse(From == params$address, "From", "Other"))) %>%
  filter(Type %in% c("In", "Out")) %>%
  mutate(Date = as.Date(Date)) %>%
  mutate(EtherValue = ifelse(Type == "Out", -EtherValue, EtherValue)) %>%
  group_by(Type, Date) %>%
  summarize(val = sum(EtherValue)) %>%
  mutate(cumval = cumsum(val)) %>%
  ggplot(aes(x=Date, y=cumval, color=Type)) +
  geom_line() +
  labs(title="Ether In/Out", y="Cumulative Ether In/Out")

data.set %>%
  filter(To == params$address) %>%
  ggplot(aes(x=BlockNumber, fill=`FunctionName`)) +
  geom_histogram() +
  labs(title = paste0("Functions called on address ", params$address))
```


---
title: `r params$name`
---
